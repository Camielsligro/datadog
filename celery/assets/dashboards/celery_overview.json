{
  "title": "Celery - Overview",
  "description": "",
  "widgets": [
    {
      "id": 6758084639687607,
      "definition": {
        "title": "Worker and Tasks Statistics",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 7490466334641725,
            "definition": {
              "title": "Active Tasks by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "avg:celery.worker.tasks.active{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 6,
              "height": 2
            }
          },
          {
            "id": 7840816765882488,
            "definition": {
              "title": "Reserved Tasks by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "avg:celery.worker.tasks.reserved{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 6,
              "height": 2
            }
          },
          {
            "id": 8179215055706504,
            "definition": {
              "title": "Scheduled Tasks by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "avg:celery.worker.tasks.scheduled{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 6,
              "height": 2
            }
          },
          {
            "id": 757450221207309,
            "definition": {
              "title": "Revoked Tasks by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "avg:celery.worker.tasks.revoked{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 2,
              "width": 6,
              "height": 2
            }
          },
          {
            "id": 3194099271440228,
            "definition": {
              "title": "Tasks Completed per Second",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "per_second(query1)"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "sum:celery.worker.task_count{$scope} by {task}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 12,
              "height": 2
            }
          },
          {
            "id": 866997060295384,
            "definition": {
              "title": "Active Workers",
              "title_size": "16",
              "title_align": "left",
              "time": {},
              "type": "check_status",
              "check": "celery.worker.ping",
              "grouping": "cluster",
              "group": "$datacenter",
              "group_by": [],
              "tags": [
                "$scope"
              ]
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 8164676351426699,
            "definition": {
              "title": "Pre-fetch Count",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "data_source": "metrics",
                      "name": "query1",
                      "query": "avg:celery.worker.prefetch_count{$scope,$scope} by {worker}"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 6,
              "width": 9,
              "height": 2
            }
          },
          {
            "id": 1934507494692418,
            "definition": {
              "title": "Worker Uptime and Total Amount of Finished Tasks",
              "title_size": "16",
              "title_align": "left",
              "time": {},
              "type": "query_table",
              "requests": [
                {
                  "queries": [
                    {
                      "data_source": "metrics",
                      "name": "query1",
                      "query": "max:celery.worker.uptime{$scope} by {worker}",
                      "aggregator": "last"
                    },
                    {
                      "data_source": "metrics",
                      "name": "query2",
                      "query": "sum:celery.worker.task_count{$scope} by {worker}",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "conditional_formats": [],
                      "cell_display_mode": "bar",
                      "alias": "uptime",
                      "formula": "query1"
                    },
                    {
                      "conditional_formats": [],
                      "cell_display_mode": "bar",
                      "alias": "finished tasks",
                      "formula": "query2",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar"
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 8,
              "width": 6,
              "height": 3
            }
          },
          {
            "id": 2326174064807612,
            "definition": {
              "title": "Top 10 Tasks",
              "title_size": "16",
              "title_align": "left",
              "time": {},
              "type": "toplist",
              "requests": [
                {
                  "style": {
                    "palette": "green"
                  },
                  "queries": [
                    {
                      "data_source": "metrics",
                      "name": "query1",
                      "query": "sum:celery.worker.task_count{$scope} by {task}",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 8,
              "width": 6,
              "height": 3
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 12,
        "height": 12
      }
    },
    {
      "id": 4368188855370278,
      "definition": {
        "title": "Resource Usage",
        "background_color": "vivid_blue",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 2903293492671648,
            "definition": {
              "title": "CPU Time Spent by Worker",
              "title_size": "16",
              "title_align": "left",
              "time": {},
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "max:celery.worker.rusage.utime{$scope} by {worker}",
                      "aggregator": "last"
                    },
                    {
                      "name": "query2",
                      "data_source": "metrics",
                      "query": "max:celery.worker.rusage.stime{$scope} by {worker}",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "alias": "time",
                      "formula": "query1 + query2"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  }
                }
              ],
              "type": "sunburst"
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 12,
              "height": 4
            }
          },
          {
            "id": 7264990391748835,
            "definition": {
              "title": "Disk Usage by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "outblock",
                      "formula": "query1"
                    },
                    {
                      "alias": "inblock",
                      "formula": "query2"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "max:celery.worker.rusage.oublock{$scope} by {worker}"
                    },
                    {
                      "name": "query2",
                      "data_source": "metrics",
                      "query": "max:celery.worker.rusage.inblock{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "blue",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 12,
              "height": 2
            }
          },
          {
            "id": 5714875838830743,
            "definition": {
              "title": "Max RSS by Worker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "time": {},
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "max:celery.worker.rusage.maxrss{$scope} by {worker}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "blue",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 12,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 12,
        "height": 9,
        "is_column_break": true
      }
    }
  ],
  "template_variables": [
    {
      "name": "scope",
      "available_values": [],
      "default": "*"
    }
  ],
  "layout_type": "ordered",
  "notify_list": [],
  "reflow_type": "fixed"
}

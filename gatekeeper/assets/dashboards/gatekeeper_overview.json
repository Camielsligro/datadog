{"title":"Gatekeeper Overview","description":"","widgets":[{"id":2525687926129783,"layout":{"x":0,"y":0,"width":29,"height":12},"definition":{"type":"image","url":"https://d33wubrfki0l68.cloudfront.net/037435cf0eb3b77f6d9080c7b25c54191490aa8d/c4776/img/logos/opa-horizontal-color.png","sizing":"fit","margin":"small"}},{"id":2373762142354972,"layout":{"x":0,"y":41,"width":47,"height":36},"definition":{"title":"Gatekeeper Logs","title_size":"16","title_align":"left","type":"log_stream","indexes":[],"query":"source:gatekeeper","sort":{"column":"time","order":"desc"},"columns":["core_host","core_service"],"show_date_column":true,"show_message_column":true,"message_display":"expanded-md"}},{"id":8795394413575891,"layout":{"x":0,"y":13,"width":47,"height":5},"definition":{"type":"note","content":"Violations","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":2485976784376809,"layout":{"x":0,"y":19,"width":47,"height":15},"definition":{"title":"Number of violations per constraint","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:gatekeeper.violations{*} by {enforcement_action}","on_right_yaxis":false,"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"markers":[]}},{"id":6829868450502189,"layout":{"x":48,"y":13,"width":47,"height":5},"definition":{"type":"note","content":"Webhook metrics","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":7137085095709307,"layout":{"x":48,"y":19,"width":47,"height":15},"definition":{"title":"Avg latency of webhook requests","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"avg:gatekeeper.request.duration.seconds.sum{*} by {admission_status}.as_count()/avg:gatekeeper.request.duration.seconds.count{*} by {admission_status}.as_count()","on_right_yaxis":false,"style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"min":"0"},"markers":[]}},{"id":2789367939595781,"layout":{"x":30,"y":0,"width":17,"height":12},"definition":{"title":"Gatekeeper Service Status","title_size":"16","title_align":"center","type":"check_status","check":"gatekeeper.health","grouping":"cluster","group_by":[],"tags":[]}},{"id":4443578023844538,"layout":{"x":48,"y":35,"width":47,"height":15},"definition":{"title":"Number of requests to webhook","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"sum:gatekeeper.request.count{*} by {admission_status}.as_count()","on_right_yaxis":false,"style":{"palette":"warm","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"min":"0"},"markers":[]}},{"id":1293226715483882,"layout":{"x":48,"y":0,"width":18,"height":12},"definition":{"title":"# of constraints","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"q":"sum:gatekeeper.constraints{*}","aggregator":"last"}],"autoscale":false,"precision":0}},{"id":2005458748746522,"layout":{"x":0,"y":35,"width":47,"height":5},"definition":{"type":"note","content":"Gatekeeper Logs","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":4686172241685874,"layout":{"x":67,"y":0,"width":18,"height":12},"definition":{"title":"# of constraint tmpl","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"q":"sum:gatekeeper.constraint_templates{*}","aggregator":"last"}],"autoscale":false,"precision":0}},{"id":805570206584576,"layout":{"x":48,"y":51,"width":47,"height":5},"definition":{"type":"note","content":"Audit metrics","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":4270481981284226,"layout":{"x":48,"y":57,"width":47,"height":15},"definition":{"title":"Average duration of the audit operation","title_size":"16","title_align":"left","show_legend":false,"type":"timeseries","requests":[{"q":"avg:gatekeeper.audit.duration.seconds.sum{*}.as_count()/avg:gatekeeper.audit.duration.seconds.count{*}.as_count()","on_right_yaxis":false,"style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"min":"0"},"markers":[]}},{"id":7217280717570321,"layout":{"x":96,"y":13,"width":47,"height":21},"definition":{"title":"Gatekeeper Pods","title_size":"16","title_align":"center","type":"hostmap","requests":{"fill":{"q":"avg:process.stat.container.cpu.total_pct{short_image:gatekeeper} by {host}"}},"node_type":"container","no_metric_hosts":true,"no_group_hosts":true,"group":["kube_deployment"],"scope":["short_image:gatekeeper"],"style":{"palette":"green_to_orange","palette_flip":false}}},{"id":1901713774173840,"layout":{"x":96,"y":35,"width":47,"height":5},"definition":{"type":"note","content":"Sync metrics","background_color":"gray","font_size":"18","text_align":"center","show_tick":false,"tick_pos":"50%","tick_edge":"bottom"}},{"id":2955812340648936,"layout":{"x":86,"y":0,"width":18,"height":12},"definition":{"title":"#  obj intended","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"q":"avg:gatekeeper.watch.intended{*}","aggregator":"avg"}],"autoscale":true,"precision":2}},{"id":1861456785471476,"layout":{"x":105,"y":0,"width":18,"height":12},"definition":{"title":"#  obj watched","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"q":"avg:gatekeeper.watch.intended{*}","aggregator":"avg"}],"autoscale":true,"precision":2}},{"id":4682508384054557,"layout":{"x":124,"y":0,"width":18,"height":12},"definition":{"title":"intended - watched","title_size":"16","title_align":"left","time":{},"type":"query_value","requests":[{"q":"avg:gatekeeper.watch.intended{*}-avg:gatekeeper.watch.watched{*}","aggregator":"avg","conditional_formats":[{"comparator":">","palette":"white_on_red","value":0}]}],"autoscale":true,"precision":2}},{"id":7844838750400424,"layout":{"x":96,"y":41,"width":47,"height":15},"definition":{"title":"Cached resources per kind","title_size":"16","title_align":"left","show_legend":false,"time":{},"type":"timeseries","requests":[{"q":"max:gatekeeper.sync{*} by {kind}","on_right_yaxis":false,"style":{"palette":"cool","line_type":"solid","line_width":"normal"},"display_type":"bars"}],"yaxis":{"scale":"linear","label":"","include_zero":true,"min":"auto","max":"auto"},"markers":[]}},{"id":2393074026676988,"layout":{"x":96,"y":57,"width":47,"height":15},"definition":{"title":"Average duration of the sync operation","title_size":"16","title_align":"left","show_legend":false,"time":{},"type":"timeseries","requests":[{"q":"avg:gatekeeper.sync.duration.seconds.sum{*}.as_count()/avg:gatekeeper.sync.duration.seconds.count{*}.as_count()","on_right_yaxis":false,"style":{"palette":"purple","line_type":"solid","line_width":"normal"},"display_type":"line"}],"yaxis":{"include_zero":false,"min":"0"},"markers":[]}}],"template_variables":[],"layout_type":"free","is_read_only":false,"notify_list":[],"id":"qp6-b9g-suy"}
